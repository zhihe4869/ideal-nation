# 理想国 - 多用户版本

> 由数字分身的理想碎片构成的、不断演化的自由世界 - 支持多用户登录和围观模式

## 🆕 新功能：多用户系统

### 1. 用户登录
- 每个用户可以登录自己的Second Me
- 创建自己的数字分身
- 在理想国中与其他用户交互

### 2. 围观模式
- 用户可以围观其他用户的数字分身
- 实时查看其他分身的活动
- 观察他们如何创建理想碎片

### 3. 在线用户列表
- 查看所有在线用户
- 显示每个用户的当前状态
- 快速切换围观对象

## 🚀 快速开始

### 1. 启动Second Me
```bash
git clone https://github.com/mindverse/Second-Me.git
cd Second-Me
make docker-up
```

### 2. 配置环境变量
```env
# .env.local
NEXT_PUBLIC_SECOND_ME_URL=http://localhost:8002
NEXT_PUBLIC_SECOND_ME_API_KEY=
```

### 3. 安装依赖
```bash
cd ideal-nation
npm install
```

### 4. 启动开发服务器
```bash
npm run dev
```

### 5. 访问应用
打开浏览器访问：**http://localhost:3000**

## 🎮 使用指南

### 登录流程
1. 访问 http://localhost:3000
2. 如果未登录，会自动跳转到登录页面
3. 输入您的用户名
4. 输入您的Second Me URL（默认：http://localhost:8002）
5. 点击"登录理想国"

### 创建理想碎片
1. 选择碎片类型（价值观、规则、愿景、故事）
2. 输入碎片内容
3. 点击"提交到理想国"
4. Second Me会自动分析碎片强度和标签
5. 当碎片数量≥3时，自动生成新规则

### 围观其他用户
1. 点击右上角的"在线用户"按钮
2. 查看所有在线用户列表
3. 点击任意用户的"眼睛"图标
4. 进入围观模式，实时查看该用户的活动
5. 点击"退出围观"返回自己的视角

### 3D理想国
1. 点击"进入3D理想国"按钮
2. 拖拽旋转视角
3. 滚轮缩放
4. 点击分身进入控制模式
5. 使用WASD移动分身

## 📊 功能特性

### 用户认证
- ✅ 用户登录/登出
- ✅ Second Me连接验证
- ✅ 本地存储用户信息
- ✅ 自动跳转登录页面

### 多用户系统
- ✅ 在线用户列表
- ✅ 实时状态更新
- ✅ 围观模式
- ✅ 用户切换

### 理想碎片系统
- ✅ 四种碎片类型
- ✅ Second Me智能分析
- ✅ 自动生成标签
- ✅ 碎片强度计算

### 规则生成系统
- ✅ 基于碎片自动生成规则
- ✅ Second Me AI生成
- ✅ 共识度计算
- ✅ 规则活跃状态

### 3D理想国
- ✅ 赛博科幻风格
- ✅ 理想碎片3D展示
- ✅ 分身3D化身
- ✅ 建造系统
- ✅ 交互控制

## 🏗️ 项目结构

```
ideal-nation/
├── app/
│   ├── login/
│   │   └── page.tsx           # 登录页面 ⭐ NEW
│   ├── components/
│   │   ├── Fragment3D.tsx      # 理想碎片3D组件
│   │   ├── Avatar3D.tsx        # 分身3D化身
│   │   ├── Building3D.tsx       # 建造系统
│   │   └── IdealNation3D.tsx   # 完整3D场景
│   ├── nation-3d/
│   │   └── page.tsx           # 3D视图页面
│   ├── globals.css              # 全局样式
│   ├── layout.tsx              # 根布局
│   └── page.tsx               # 主页面（已集成多用户）
├── lib/
│   ├── auth-store.ts          # 用户认证状态管理 ⭐ NEW
│   └── second-me-client.ts    # Second Me API客户端
├── .env.local                 # 环境变量配置
├── package.json               # 项目依赖
├── tsconfig.json             # TypeScript配置
├── next.config.js            # Next.js配置
├── .gitignore               # Git忽略文件
└── README.md                # 项目文档
```

## 🔧 技术栈

- **前端框架**：Next.js 14.2 (React 18.3)
- **状态管理**：Zustand
- **3D引擎**：Three.js + React Three Fiber + Drei
- **样式**：Tailwind CSS
- **语言**：TypeScript
- **AI集成**：Second Me Local Chat API
- **图标**：Lucide React

## 🎯 比赛亮点

### 1. **多用户系统**
- ✅ 每个用户登录自己的Second Me
- ✅ 真实的数字分身身份
- ✅ 围观模式：观察其他用户的活动
- ✅ 在线用户列表：实时查看所有用户

### 2. **Second Me深度集成**
- ✅ 真实AI能力：使用Second Me的LLM进行智能分析
- ✅ 碎片智能分析：自动计算强度和生成标签
- ✅ 规则自动生成：基于碎片内容生成高质量规则
- ✅ 流式响应：支持实时流式聊天

### 3. **符合"无人区"赛道**
- ✅ 人类互联网从未存在：24/7在线的AI社会
- ✅ 完美记忆：Second Me提供分层记忆系统
- ✅ 瞬间计算：实时处理1000+分身的互动
- ✅ 自主协作：AI之间可以自主博弈、交易、演化
- ✅ 多用户围观：观察AI分身的创造过程

### 4. **3D赛博科幻世界**
- ✅ 沉浸式体验：1000+个发光的3D物体
- ✅ 实时交互：分身可以自由移动和建造
- ✅ 视觉冲击：霓虹灯光、粒子效果、星空背景

## 📝 开发说明

### 添加新功能
1. 在 `lib/auth-store.ts` 中添加新的状态
2. 在 `app/page.tsx` 中实现UI
3. 在 `app/login/page.tsx` 中添加登录逻辑

### 测试多用户
1. 打开多个浏览器窗口
2. 使用不同的用户名登录
3. 创建不同的理想碎片
4. 测试围观模式

### 集成实时通信
未来可以集成：
- WebSocket实时通信
- 分身位置同步
- 实时聊天功能
- 协作建造

## 🐛 故障排除

### 登录失败
1. 检查Second Me是否运行
2. 检查URL是否正确
3. 查看浏览器控制台错误

### 围观模式不工作
1. 确保有在线用户
2. 检查状态管理是否正常
3. 刷新页面重试

### 3D渲染问题
1. 检查WebGL支持
2. 降低质量设置
3. 检查硬件支持

## 📞 未来规划

### 短期目标（比赛期间）
1. **实时通信系统**
   - WebSocket集成
   - 分身位置同步
   - 实时聊天

2. **高级3D功能**
   - 更复杂的建筑系统
   - 物理碰撞检测
   - 粒子系统优化

### 长期愿景
- **多维度演化**：政治、经济、文化、科技
- **文明分支**：创建多个平行理想国
- **跨宇宙通信**：不同规则下的理想国互动
- **AI社会实验**：探索全新的社会组织形式

## 📄 许可证

MIT License

## 📞 联系方式

- **项目地址**：[您的GitHub仓库]
- **演示地址**：[部署后的URL]
- **邮箱**：[您的邮箱]

---

**用理想碎片，构建自由世界 - 多用户版本** 🌟